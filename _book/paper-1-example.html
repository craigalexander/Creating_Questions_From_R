<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 2021 Paper 1 Example | Using R to generate data for questions</title>
<meta name="author" content="Craig Alexander &amp; Eilidh Jack">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 2 2021 Paper 1 Example | Using R to generate data for questions">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 2021 Paper 1 Example | Using R to generate data for questions">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="2.1 Question 1 In this example, we will take a look at question 1 from Paper 1 in 2021. This question is a report style question based on Google AI data of times taken to draw a cat or a dog. The...">
<meta property="og:description" content="2.1 Question 1 In this example, we will take a look at question 1 from Paper 1 in 2021. This question is a report style question based on Google AI data of times taken to draw a cat or a dog. The...">
<meta name="twitter:description" content="2.1 Question 1 In this example, we will take a look at question 1 from Paper 1 in 2021. This question is a report style question based on Google AI data of times taken to draw a cat or a dog. The...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Using R to generate data for questions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Overview</a></li>
<li><a class="active" href="paper-1-example.html"><span class="header-section-number">2</span> 2021 Paper 1 Example</a></li>
<li><a class="" href="linear-model-example.html"><span class="header-section-number">3</span> Linear model example</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="paper-1-example" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> 2021 Paper 1 Example<a class="anchor" aria-label="anchor" href="#paper-1-example"><i class="fas fa-link"></i></a>
</h1>
<div id="question-1" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Question 1<a class="anchor" aria-label="anchor" href="#question-1"><i class="fas fa-link"></i></a>
</h2>
<p>In this example, we will take a look at question 1 from <a href="https://www.sqa.org.uk/sqa/files_ccc/NAH_Statistics_Paper1_2021.pdf">Paper 1</a> in 2021. This question is a report style question based on Google AI data of times taken to draw a cat or a dog. The example contains a stem and leaf diagram with the combined data and some summary statistics for both sets of drawings. Following this, a Mann-Whitney Test is carried out to test whether both samples have different average drawing times.</p>
<p>We will now look at how we can simulate a sample of the data from the question, by randomly sampling data for both groups using properties from their summary statistics</p>
<div id="generating-a-random-sample-of-data" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> Generating a random sample of data<a class="anchor" aria-label="anchor" href="#generating-a-random-sample-of-data"><i class="fas fa-link"></i></a>
</h3>
<p>We can generate a random sample of data for both the categories using the summary statistics provided. As we can see from the stem and leaf diagram, the data have a lower bound, where we cannot observe any data below zero, as the data recorded are based on time elapsed.</p>
<p>In order to sample data of this form, we can use a variation of the Normal distribution called the <a href="https://en.wikipedia.org/wiki/Truncated_normal_distribution">truncated normal distribution</a>, which allows us to bound a Normal distribution through a given range.</p>
<p>To randomly sample data from this distribution, we can use the <code>rtruncnorm</code> function from the <code>truncnorm</code> package in R as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">121</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">14</span>, mean<span class="op">=</span><span class="fl">5.4</span>, sd<span class="op">=</span><span class="fl">2.31</span><span class="op">)</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span></code></pre></div>
<p>The parameters required are defined as follows:</p>
<ul>
<li>
<code>n</code> - the number of samples we wish to draw</li>
<li>
<code>a</code> - the lower bound of the distribution (here, we will set this to 0)</li>
<li>
<code>b</code> - the upper bound of the distribution (here, we have set this to be the ceiling of the max value for each group)</li>
<li>
<code>mean</code> - the mean of each group</li>
<li>
<code>sd</code> - the standard deviation of each group</li>
</ul>
<p>Running the code above will produce a sample for both groups based on their relative summary statistics. We can check the summary statistics of our data using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_cat</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.3641  3.4919  4.7518  5.0838  6.3575 11.2882</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2323  6.4623  8.1252  7.9339  9.3019 15.5964</code></pre>
<p>We can now compare these summary statistics to those of the real data provided in the paper and notice that our simulated data produces fairly similar summary statistics.</p>
<p><strong>Exercise</strong>
Try editing some of the parameters in <code>rtruncnorm</code> to see how this changes the summary statistics you obtain.</p>
</div>
<div id="visualising-the-data" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> Visualising the data<a class="anchor" aria-label="anchor" href="#visualising-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>We can also check the distribution of our sampled data for comparison by visualising it using a histogram. The <code>ggplot2</code> library found in the <code>tidyverse</code> library provides several functions for data visualisation and has become more popular than base R graphics. We will use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> function from the library in this example as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dog_hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_dog</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of dogs"</span>,x<span class="op">=</span><span class="st">"Time (s)"</span><span class="op">)</span>
<span class="va">cat_hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_cat</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_cat</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of cats"</span>,x<span class="op">=</span><span class="st">"Time (s)"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">cat_hist</span>, <span class="va">dog_hist</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="bookdown-demo_files/figure-html/histograms-1.png" width="672"></div>
<p>To create these histograms, the code above works in the following fashion:</p>
<ul>
<li>We first specify our data using <code>ggplot(data)</code>, where our data here is either group of samples.</li>
<li>To specify which variables we would like to select, we use the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> argument. As we only have one sample of data in each case, we specify this using <code>x=data</code>.</li>
<li>We then generate the histogram using <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, where we can define the line colour using <code>color</code> and the filled colour of the bars using <code>fill</code>.</li>
<li>We can label our plot using the <code>labs</code> argument, where we can include a <code>title</code> and an <code>x</code> axis label</li>
</ul>
<p>We can also alter the number of bins we use (<code>ggplot</code> will set a standard number of bins by default) using the <code>bins</code> argument. Let’s alter the number of bins for the dog data to be 10</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dog_hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_dog</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span>,bins<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of dogs"</span>,x<span class="op">=</span><span class="st">"Time (s)"</span><span class="op">)</span></code></pre></div>
<p><strong>Exercise</strong>
Try edit some of the inputs to the histogram plot. You can change the colour scheme, number of bins and the labels for the plot.</p>
</div>
<div id="setting-random-seeds-for-reproducibility" class="section level3" number="2.1.3">
<h3>
<span class="header-section-number">2.1.3</span> Setting random seeds for reproducibility<a class="anchor" aria-label="anchor" href="#setting-random-seeds-for-reproducibility"><i class="fas fa-link"></i></a>
</h3>
<p>When we randomly sample data each time in R, we will obtain a different sample than before. Let’s run our previous code twice to see if there is any differences:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_dog1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>
<span class="va">sample_dog2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_dog1</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4464  5.7736  7.3936  7.5150  9.2837 13.4899</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_dog2</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2391  5.3456  7.5616  7.4537  9.2504 13.4568</code></pre>
<p>We see that both samples produce different summary statistics. This can cause difficulty when you are working on a specific problem and want to design questions around the specific characteristics of the data you have sampled the first time.</p>
<p>We can force R to use the same random number generation by using the <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> function. Here, we specify the seed from the random number generator we want to use each time we generate samples. This number can be any number you wish to choose! The example below highlights how this works:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>
<span class="va">sample_dog1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>
<span class="va">sample_dog2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_dog1</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.006   6.316   7.545   7.798   9.365  14.776</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sample_dog2</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.006   6.316   7.545   7.798   9.365  14.776</code></pre>
<p>Here, we see we can produce the same data as the first sample by setting the seed prior to sampling.</p>
<p><strong>Exercise</strong>
Try setting your own choice of random seed here and see how the summary statistics change.</p>
</div>
<div id="manually-editing-data" class="section level3" number="2.1.4">
<h3>
<span class="header-section-number">2.1.4</span> Manually editing data<a class="anchor" aria-label="anchor" href="#manually-editing-data"><i class="fas fa-link"></i></a>
</h3>
<p>If we take a sample of data and perhaps wish to add some additional variables to mimic the original data closer, this can easily be done in R. Let’s take a sample for the dog data but lower our boundary to 14 and visualise.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">14</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_dog</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span>,bins<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of dogs"</span>,x<span class="op">=</span><span class="st">"Time(s)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-demo_files/figure-html/lowsample-1.png" width="672"></div>
<p>When comparing this to the original data from the paper, we see that we do not observe the two outliers at 14.3 seconds and 15.2 seconds. In order to maintain the same sample size, we can reduce our samples here to be 143, and then manually add the two outliers. We can manually add these values as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">143</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">14</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sample_dog</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14.3</span>,<span class="fl">15.2</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_dog</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span>,bins<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of dogs"</span>,x<span class="op">=</span><span class="st">"Time (s)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-demo_files/figure-html/modify-1.png" width="672"></div>
<p>We now observe the two additional values in the histogram. For a vector of data, we can easily add new values using the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> command. This can be done by specifying our original data first, and then including our additional variables in a new <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> object. If we only wish to add one value, we do not need to use <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>.</p>
<p>We can also make this update in a slightly different way. If we take our original sample of 145, we can directly replace two of the observations we have. We can replace the two highest values from our sampled data with the two outliers as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">14</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>

<span class="co"># Order the data from higest to lowest</span>
<span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="va">sample_dog</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">sample_dog</span>,decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Replace the 2 highest values with our outliers</span>
<span class="va">sample_dog</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14.3</span>,<span class="fl">15.2</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sample_dog</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sample_dog</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span>,bins<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Average draw time of dogs"</span>,x<span class="op">=</span><span class="st">"Time (s)"</span><span class="op">)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/lowsample2-1.png" width="672">
Here, we have used the <code>order</code> function to sort our data from the highest numerical observation to the lowest. The <code>decreasing=TRUE</code> argument sets this order from highest to lowest. If you wanted to replace the two lowest arguments, you can simply drop the <code>decreasing=TRUE</code> argument here. We then update the first two observations with our two outliers.</p>
<p><strong>Exercise</strong>
Try replacing the two lowest values of your sampled data with the two identified outliers.</p>
</div>
<div id="sampling-from-different-distributions" class="section level3" number="2.1.5">
<h3>
<span class="header-section-number">2.1.5</span> Sampling from different distributions<a class="anchor" aria-label="anchor" href="#sampling-from-different-distributions"><i class="fas fa-link"></i></a>
</h3>
<p>In this case, the data shown roughly takes the form of a Normal distribution. There are several cases where this may not be an appropriate distribution. R contains a full range of different distributions we can sample from. Some common choices are shown below:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code> - Sample from a Binomial distribution</li>
<li>
<code><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq()</a></code> - Sample from a Chi-squared distribution</li>
<li>
<code><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma()</a></code> - Sample from a Gamma distribution</li>
<li>
<code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> - Sample from a Uniform distribution</li>
<li>
<code><a href="https://rdrr.io/r/stats/Exponential.html">rexp()</a></code> - Sample from an Exponential distribution</li>
</ul>
<p>This list is not exhaustive, and R will contain libraries that will allow sampling from almost any known distribution.</p>
<p><strong>Exercise</strong>
Carry out the steps we have worked through above, but this time using a different distribution of your choice. You can find information on what parameters need to be specified using the <code>?</code> notation before the function name (e.g. <code><a href="https://rdrr.io/r/stats/Exponential.html">?rexp</a></code>)</p>
</div>
<div id="performing-a-mann-whitney-test" class="section level3" number="2.1.6">
<h3>
<span class="header-section-number">2.1.6</span> Performing a Mann-Whitney Test<a class="anchor" aria-label="anchor" href="#performing-a-mann-whitney-test"><i class="fas fa-link"></i></a>
</h3>
<p>We can carry out a Mann-Whitney test in R as follows</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_dog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">145</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">16</span>, mean<span class="op">=</span><span class="fl">7.5</span>, sd<span class="op">=</span><span class="fl">2.66</span><span class="op">)</span>
<span class="va">sample_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">121</span>, a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">14</span>, mean<span class="op">=</span><span class="fl">5.4</span>, sd<span class="op">=</span><span class="fl">2.31</span><span class="op">)</span>

<span class="va">mann_whitney</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">sample_dog</span>,<span class="va">sample_cat</span><span class="op">)</span>
<span class="va">mann_whitney</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  sample_dog and sample_cat
## W = 13000, p-value = 1.33e-11
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The output from this test gives us the rank sum <code>W</code> and a p-value which can be used for question creation</p>
</div>
</div>
<div id="performing-a-z-test" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Performing a z-test<a class="anchor" aria-label="anchor" href="#performing-a-z-test"><i class="fas fa-link"></i></a>
</h2>
<p>We can perform a two-sample z test in R using the <code>z.test</code> function from the <code>BSDA</code> package. We can carry out this test as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://alanarnholt.github.io/BSDA/reference/z.test.html">z.test</a></span><span class="op">(</span><span class="va">sample_cat</span>,<span class="va">sample_dog</span>,sigma.x<span class="op">=</span><span class="fl">2.307</span>,sigma.y<span class="op">=</span><span class="fl">2.655</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Two-sample z-Test
## 
## data:  sample_cat and sample_dog
## z = -7.1488, p-value = 8.752e-13
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.771824 -1.578983
## sample estimates:
## mean of x mean of y 
##  5.286729  7.462132</code></pre>
<p>Here, we specify the sample standard deviation for cats and dogs respectively. The output from the test gives us the z-statistic, p-value and 95% confidence interval.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Overview</a></div>
<div class="next"><a href="linear-model-example.html"><span class="header-section-number">3</span> Linear model example</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#paper-1-example"><span class="header-section-number">2</span> 2021 Paper 1 Example</a></li>
<li>
<a class="nav-link" href="#question-1"><span class="header-section-number">2.1</span> Question 1</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#generating-a-random-sample-of-data"><span class="header-section-number">2.1.1</span> Generating a random sample of data</a></li>
<li><a class="nav-link" href="#visualising-the-data"><span class="header-section-number">2.1.2</span> Visualising the data</a></li>
<li><a class="nav-link" href="#setting-random-seeds-for-reproducibility"><span class="header-section-number">2.1.3</span> Setting random seeds for reproducibility</a></li>
<li><a class="nav-link" href="#manually-editing-data"><span class="header-section-number">2.1.4</span> Manually editing data</a></li>
<li><a class="nav-link" href="#sampling-from-different-distributions"><span class="header-section-number">2.1.5</span> Sampling from different distributions</a></li>
<li><a class="nav-link" href="#performing-a-mann-whitney-test"><span class="header-section-number">2.1.6</span> Performing a Mann-Whitney Test</a></li>
</ul>
</li>
<li><a class="nav-link" href="#performing-a-z-test"><span class="header-section-number">2.2</span> Performing a z-test</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Using R to generate data for questions</strong>" was written by Craig Alexander &amp; Eilidh Jack. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
